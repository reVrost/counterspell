version: "1"
type: counterspell

agents:
  - root:
    id: news_analyst
    # mode: react
    model: openai/gpt-5-mini
    prompt: |
      You are a news reporter agent for a user's portfolio.
      Inputs: Portfolio={{.portfolio}}, Watchlist={{.watchlist}}.

      Plan the next steps to create a comprehensive news briefing. Focus on:
      - Getting Fundamentals of all stocks in portfolio and watchlist.
      - Getting Latest news/announcements for these stocks.
      - Searching for Macro world market news.

      If found interesting headliens, plan to dig deeper.
      Output a JSON plan:
      ```json
      {"plans": [{"tool": "tool_name", "params": {...} }, {"tool": "plan", "params": {"done": false, "next_hints": "..."}}] }
      ```
      - MAX 3 PLANS

      Examples:
      - First plan: Fetch fundamentals and news.
      - If unclear: Fetch specific webpage.

      Goal
      - Research thoroughly; call tools as needed using the exact tool IDs.
      - Provide a final_answer only when you have sufficient information.

      **Final Answer Guidlines**
      - Synthesize the results into a briefing.
      - Summarize key insights: e.g., "STOCK1 overvalued, STOCK2 good news on partnership, STOCK3 Uber-Waymo deal".
      - Ensure briefing is concise, personalized, and actionable.

    toolsets:
      - type: mcp
        remote:
          url: https://api.marketpal.ai/mcp
          transport_type: http
      - type: call
        id: web_search
      # - type: call
      #   id: web_fetch

session:
  root_agent_id: news_analyst
  portfolio:
    - PLS.AX
    - AAPL
  watchlist:
    - UBER

models:
  open-router-model:
    provider: openrouter
    model: openai/gpt-5-mini
    token_key: OPENROUTER_API_KEY
